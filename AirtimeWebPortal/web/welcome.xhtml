<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
      xmlns:a="http://xmlns.jcp.org/jsf/passthrough"
      xmlns:tp="http://java.sun.com/jsf/composite/ecomp"
      xmlns:f="http://xmlns.jcp.org/jsf/core">
    <h:head>
        <meta http-equiv="X-UA-Compatible" content="IE=edge"/>
        <meta name="viewport" content="width=device-width, initial-scale=1"/>
        
        <title>AIRTIME WebPortal for Customer</title>
        
        <link href="css_cust/bootstrap.css" rel="stylesheet"/> 
        <link rel="stylesheet" href="css_cust/fontawesome/css/font-awesome.min.css" />
        
        <link href="css_cust/style.css" rel="stylesheet"/>
        <link href="css_cust/menu.css" rel="stylesheet"/>
        <link href="css_cust/topheader.css" rel="stylesheet"/>
        <link href="css_cust/footer.css" rel="stylesheet"/>
        <link href="css_cust/forms.css" rel="stylesheet" />
        <link href="css_cust/hover.css" rel="stylesheet" />
        <link href="css_cust/mobmenu.css" rel="stylesheet" />
        
        <script type="text/javascript" src="js_cust/jquery-1.12.0.min.js"></script>	
        <script type="text/javascript" src="js_cust/bootstrap.min2.js"></script>	
        
        <link href="js_cust/easyresponsivetabs/easy-responsive-tabs.css" rel="stylesheet" />
        <script src="js_cust/easyresponsivetabs/easy-responsive-tabs.js" type="text/javascript"></script>
        
        <link href="js_cust/datatable/jquery.dataTables.min.css" rel="stylesheet" />
        <link href="js_cust/datatable/buttons.dataTables.min.css" rel="stylesheet" />
        <script type="text/javascript" src="js_cust/datatable/jquery.dataTables.min.js"></script>	
        <script type="text/javascript" src="js_cust/datatable/dataTables.buttons.min.js"></script>	
        <script type="text/javascript" src="js_cust/datatable/buttons.flash.min.js"></script>	
        <script type="text/javascript" src="js_cust/datatable/jszip.min.js"></script>	
        <script type="text/javascript" src="js_cust/datatable/pdfmake.min.js"></script>	
        <script type="text/javascript" src="js_cust/datatable/vfs_fonts.js"></script>	
        <script type="text/javascript" src="js_cust/datatable/buttons.html5.min.js"></script>
        
        <script>
            $(document).ready(function () {
                $('#dataTableList').DataTable({
                    "paging": true,
                    "iDisplayLength": 6,
                    "searching": true,
                    "ordering": true,
                    "info": true,
                    dom: 'Bfrtip',
                    buttons: [
                        'excelHtml5',
                        'csvHtml5',
                        'pdfHtml5'
                    ],
                })
            });
        </script>
        
        
        <link type="text/css" href="js_cust/lightcase/lightcase.css" rel="stylesheet"  />
        <script type="text/javascript" src="js_cust/lightcase/lightcase.js"></script>
        <script type="text/javascript" src="js_cust/lightcase/lightcase.init.js"></script>
    </h:head>
    <h:body>
        
        <ui:include src="templates/header_inside.xhtml" />  
        
        <!-- CONTENTS-->
        <div class="container-fluid">
            <div class="col-xs-12 maincontents">
                
                <!-- ROW 1 -->
                
                <!-- customer box -->
                <div class="col-xs-12 col-sm-12 col-md-6 thebox">
                    <div class="col-xs-12 dashboardbox_account" style="margin:0px;margin-top:27px;padding:0px;min-height:420px">
                        <!-- IN -->
                        <h2>Account Status</h2>
                        
                        <span>
                            <div class="container-fluid" style="padding:0px;font-family:ubuntu;text-align:center;">
                                
                                <div class="col-xs-12" style="padding:0px;font-family:ubuntu;text-align:left;border-bottom:1px solid #f0f0f0">
                                    <span style="color:#ff5700;"><label style="width:60px;text-align:center;margin-right:5px;color:#9f9f9f;"><i class="fa fa-user" aria-hidden="true"></i> </label><strong><h:outputText value="#{CustomerBean.customerSingle.customer.fName} #{CustomerBean.customerSingle.customer.otherNames}"/></strong></span>
                                    <span style="color:#ff5700;"><label style="width:60px;text-align:center;margin-right:5px;color:#9f9f9f;"><i class="fa fa-phone" aria-hidden="true"></i></label><strong><h:outputText value="#{CustomerBean.customerSingle.customer.msisdn}"/></strong></span>
                                    <span style="color:#ff5700;"><label style="width:60px;text-align:center;margin-right:5px;color:#9f9f9f;"><i class="fa fa-envelope" aria-hidden="true"></i></label><strong><h:outputText value="#{CustomerBean.customerSingle.customer.email}"/></strong></span>
                                </div>
                                
                                <span class="homeamount">&#8358; &nbsp;&nbsp;<strong><h:outputText value="#{CustomerBean.customerSingle.nowBalance}"/></strong></span>
                                
                                <i>Latest account balance : 
                                    <h:outputText value="#{CustomerBean.date}">
                                        <f:convertDateTime type="date" pattern="EEE, d MMM yyyy HH:mm" />
                                    </h:outputText></i>
                                
                            </div>
                        </span>
                        <!-- IN -->
                    </div>
                </div>
                <!--end customer box -->
                
                
                <!-- buy airtime box -->
                <div class="col-xs-12 col-sm-12 col-md-6 thebox">
                    <div class="col-xs-12 dashboardbox" style="margin:0px;margin-top:27px;padding:0px;min-height:420px">
                        <!-- IN -->
                        <span style="padding:0px;margin:0px;">
                            <div  class="container-fluid" style="padding:0px;font-family:ubuntu;font-size:13px;">
                                <!-- Tabs -->
                                <ul class="nav nav-tabs">
                                    <li class="active">
                                        <a data-toggle="tab" href="#toone">
                                            <strong class="hidemob">Send</strong> To One
                                        </a>
                                    </li>
                                    <li>
                                        <a data-toggle="tab" href="#tomany">
                                            <strong class="hidemob">Send</strong> To Many
                                        </a>
                                    </li>
                                    <li>
                                        <a data-toggle="tab" href="#favorites">Favorites</a>
                                    </li>
                                    
                                </ul>
                                
                                <div class="tab-content">
                                    
                                    <div id="toone" class="tab-pane fade in active">
                                        
                                        <!-- FORM -->
                                        <h:form class="container-fluid login_form" id="send_one"  style="margin-top:45px;">
                                            <div class="col-xs-12 login_theinput">
                                                <h:inputText id="number" class="user" a:placeholder="Enter Phone Number" value="#{RechargeBean.phone1}"/>
                                            </div>
                                            <div class="col-xs-12 login_theinput">
                                                <h:inputText id="amount" class="pass" a:placeholder="Enter Amount" value="#{RechargeBean.amount1}"/>
                                            </div>
                                            <div class="col-xs-12 login_submitinput">
                                                <h:commandButton value="Send" action="#{RechargeBean.confirmViewOne()}">
                                                    <f:ajax execute="send_one" onevent="notifyEdit()"  rendererType="postValidate" render=":editDetailsContentPanel :edit_form" />
                                                </h:commandButton>
                                            </div>
                                        </h:form>
                                        <!-- End FORM -->
                                        
                                        <div id="warning" class="col-xs-12 warning">
                                            <h:outputText value="Your access code doesn't match, Please Try again!" rendered="#{RechargeBean.faceMessage}"/>
                                        </div>
                                        
                                    </div>
                                    
                                    
                                    <div id="tomany" class="tab-pane fade">
                                        
                                        <!-- FORM -->
                                        <h:form class="container-fluid login_form" id="send_many"  style="margin-top:45px;">
                                            
                                            <div class="col-xs-12">
                                                <div class="col-xs-12 col-sm-6">
                                                    <div class="sendairtime">
                                                        <h:inputText id="number1" class="user" a:placeholder="Enter Phone Number" value="#{RechargeBean.phone1}"/>
                                                    </div>
                                                </div>
                                                <div class="col-xs-12 col-sm-6">
                                                    <div class="sendairtime">
                                                        <h:inputText id="amount1" class="pass" a:placeholder="Enter Amount" value="#{RechargeBean.amount1}"/>
                                                    </div>
                                                </div>
                                            </div>
                                            
                                            <div class="col-xs-12">
                                                <div class="col-xs-12 col-sm-6">
                                                    <div class="sendairtime">
                                                        <h:inputText id="number2" class="user" a:placeholder="Enter Phone Number" value="#{RechargeBean.phone2}"/>
                                                    </div>
                                                </div>
                                                <div class="col-xs-12 col-sm-6">
                                                    <div class="sendairtime">
                                                        <h:inputText id="amount2" class="pass" a:placeholder="Enter Amount" value="#{RechargeBean.amount2}"/>
                                                    </div>
                                                </div>
                                            </div>
                                            
                                            <div class="col-xs-12">
                                                <div class="col-xs-12 col-sm-6">
                                                    <div class="sendairtime">
                                                        <h:inputText id="number3" class="user" a:placeholder="Enter Phone Number" value="#{RechargeBean.phone3}"/>
                                                    </div>
                                                </div>
                                                <div class="col-xs-12 col-sm-6">
                                                    <div class="sendairtime">
                                                        <h:inputText id="amount3" class="pass" a:placeholder="Enter Amount" value="#{RechargeBean.amount3}"/>
                                                    </div>
                                                </div>
                                            </div>
                                            
                                            <div class="col-xs-12 login_submitinput">
                                                <h:commandButton value="Send" action="#{RechargeBean.confirmViewMany()}">
                                                    <f:ajax execute="send_many" onevent="notifyEditMany()"  rendererType="postValidate" render="editDetailsManyContentPanel :editmany_form"  />
                                                </h:commandButton>
                                            </div>
                                            
                                            
                                        </h:form>
                                        <!-- End FORM -->
                                        
                                        <div id="warning" class="col-xs-12 warning">
                                            <h:outputText value="Your access code doesn't match, Please Try again!" rendered="#{RechargeBean.faceMessage}"/>
                                        </div>
                                        
                                    </div>
                                    
                                    
                                    
                                    <div id="favorites" class="tab-pane fade">
                                        
                                        <!-- FORM -->
                                        <form class="container-fluid login_form" id="send_fav" action="" style="margin-top:15px;">
                                            
                                            <div class="col-xs-12">
                                                <div class="col-xs-12 col-sm-3"><div class="sendairtime"><h4>NAME 1</h4></div></div>
                                                <div class="col-xs-8 col-sm-5"><div class="sendairtime"><input type="text" id="amount" name="amount" class="pass" placeholder='Enter Amount'/></div></div>
                                                <div class="col-xs-4 col-sm-4"><div class="col-xs-12 login_submitinput"><a data-rel="lightcase_forgot" href="confirm.html" style="color:#a3a3a3;text-decoration:none;"><input type="submit" name="submit" value="Send"/></a></div></div>
                                            </div>
                                            
                                            <div class="col-xs-12">
                                                <div class="col-xs-12 col-sm-3"><div class="sendairtime"><h4>NAME 1</h4></div></div>
                                                <div class="col-xs-8 col-sm-5"><div class="sendairtime"><input type="text" id="amount" name="amount" class="pass" placeholder='Enter Amount'/></div></div>
                                                <div class="col-xs-4 col-sm-4"><div class="col-xs-12 login_submitinput"><a data-rel="lightcase_forgot" href="confirm.html" style="color:#a3a3a3;text-decoration:none;"><input type="submit" name="submit" value="Send"/></a></div></div>
                                            </div>
                                            
                                            <div class="col-xs-12">
                                                <div class="col-xs-12 col-sm-3"><div class="sendairtime"><h4>NAME 1</h4></div></div>
                                                <div class="col-xs-8 col-sm-5"><div class="sendairtime"><input type="text" id="amount" name="amount" class="pass" placeholder='Enter Amount'/></div></div>
                                                <div class="col-xs-4 col-sm-4"><div class="col-xs-12 login_submitinput"><a data-rel="lightcase_forgot" href="confirm.html" style="color:#a3a3a3;text-decoration:none;"><input type="submit" name="submit" value="Send"/></a></div></div>
                                            </div>
                                            
                                            <div class="col-xs-12">
                                                <div class="col-xs-12 col-sm-3"><div class="sendairtime"><h4>NAME 1</h4></div></div>
                                                <div class="col-xs-8 col-sm-5"><div class="sendairtime"><input type="text" id="amount" name="amount" class="pass" placeholder='Enter Amount'/></div></div>
                                                <div class="col-xs-4 col-sm-4"><div class="col-xs-12 login_submitinput"><a data-rel="lightcase_forgot" href="confirm.html" style="color:#a3a3a3;text-decoration:none;"><input type="submit" name="submit" value="Send"/></a></div></div>
                                            </div>
                                            
                                            
                                        </form>
                                        <!-- End FORM -->
                                        
                                        <div id="warning" class="col-xs-12 warning">This is where warnings are displayed!</div>
                                        
                                    </div>
                                    
                                    
                                </div>
                                <!-- Tabs -->
                            </div>
                        </span>
                        <!-- IN -->
                    </div>
                </div>
                <!--end buy airtime box -->
                
                
                <!-- End ROW 1 -->
                
                
                
                <div class="clear" style="margin-top:10px;"></div>
                
                
                <!-- ROW 2 -->
                
                <div class="col-xs-12 col-sm-12 col-md-6 thebox">
                    <div class="col-xs-12 dashboardbox_addamount" style="margin:0px;margin-top:27px;padding:0px;min-height:420px">
                        <!-- IN -->
                        <h2>Add amount in your Account</h2>
                        <span>
                            <div  class="container-fluid" style="padding:0px;font-family:ubuntu;font-size:13px;">
                                <!-- FORM -->
                                <h:form id="walletform" class="container-fluid"  style="margin-top:45px;">
                                    
                                    <div class="col-xs-12 dashboardbox_addamount_input">
                                        
                                        <h:inputText id="walletamount" class="amount" a:placeholder='&#8358; Enter Amount' value=""/>
                                    </div>
                                    
                                    <fieldset class="col-xs-12 dashboardbox_addamount_input"> 
                                        <legend>PAYMENT METHODS</legend>
                                        <div class="cc-selector">
                                            
                                        </div>
                                    </fieldset>
                                    
                                    <div class="col-xs-12 dashboardbox_addamount_submit">
                                        
                                        
                                        
                                        <!-- End QT Button -->
                                        <em>
                                            <small>
                                                <a class="quickteller-checkout-anchor" id="95101" style="text-align:left;">
                                                    payment button will appear here shortly...
                                                </a>
                                            </small>
                                        </em>
                                        <!-- End QT Button -->
                                        
                                        
                                    </div>
                                </h:form>
                                <!-- End FORM -->
                                
                                <div id="warning" class="col-xs-12 warning">This is where warnings are displayed!</div>
                            </div>
                        </span>
                        <!-- IN -->
                    </div>
                </div>
                
                
                
                <div class="col-xs-12 col-sm-12 col-md-6 thebox">
                    <div class="col-xs-12 dashboardbox" style="margin:0px;margin-top:27px;padding:0px;min-height:420px;overflow-x:auto;">
                        <!-- IN -->
                        <h2>Latest transactions</h2>
                        <span>
                            <div  class="container-fluid" style="padding:0px;font-family:ubuntu;font-size:13px;">
                                <!-- -->
                                
                                <h:dataTable value="#{TransactionBean.walletTransactionList.transactionList}" var="tra"
                                             id="dataTableList"
                                             styleClass="display" 
                                             cellspacing="0" 
                                             width="100%" 
                                             style="padding: 0px;">
                                    <h:column>
                                        <f:facet name="header">DATE</f:facet>
                                        <h:outputText value="#{tra.walletTransaction.transTime}">
                                            <f:convertDateTime pattern="EEE, d MMM yyyy"/>
                                        </h:outputText>
                                    </h:column>
                                    
                                    <h:column>
                                        <f:facet name="header">TIME</f:facet>
                                        <h:outputText value="#{tra.walletTransaction.transTime}">
                                            <f:convertDateTime pattern="HH:mm:ss"/>
                                        </h:outputText>
                                    </h:column>
                                    
                                    <h:column>
                                        <f:facet name="header">ACCOUNT NO.</f:facet>
                                            #{tra.walletTransaction.srcrefId}
                                    </h:column>
                                    
                                    <h:column>
                                        <f:facet name="header">AMOUNT</f:facet>
                                        &#8358; #{tra.walletTransaction.amount}
                                    </h:column>
                                    
                                    
                                    <h:column>
                                        <f:facet name="header">ACTION</f:facet>
                                        <h:form>
                                            <h:commandLink   onclick="notifiyViewDetails()" id="viewDetails"> 
                                                <h:graphicImage value="images/icon_view.png" />
                                                <f:ajax event="click" listener="#{TransactionBean.transactionForView(tra)}" render="viewDetailsContentPanel" />
                                            </h:commandLink>
                                        </h:form>
                                    </h:column>
                                </h:dataTable>
                                
                                <!-- -->
                                
                                
                                
                            </div>
                        </span>
                        <!-- IN -->
                    </div>
                </div>
                
                <!-- End ROW 2 -->
                
            </div>
        </div>
        <!-- End CONTENTS -->
        
        <!-- Popup -->
        <div id="viewDetailsContent" style="display:none">
            
            <h:panelGroup id="viewDetailsContentPanel" >
                <ui:include src="popup/view_tra.xhtml" /> 
            </h:panelGroup>
            
            <h:panelGroup id="editDetailsContentPanel">
                <h:form  id="edit_form">
                    <tp:rechargeOneComponent 
                        msisdn="#{RechargeBean.phone1}"
                        amount="#{RechargeBean.amount1}"
                        proceedButtonAction="#{RechargeBean.approveOne()}"
                        cancelButtonAction="#{RechargeBean.cancelOne()}"
                        /> 
                </h:form>
            </h:panelGroup>
            
            <h:panelGroup id="editDetailsManyContentPanel">
                <h:form id="editmany_form">
                    <tp:rechargeManyComponent 
                        msisdn1="#{RechargeBean.phone1}"
                        amount1="#{RechargeBean.amount1}"
                        msisdn2="#{RechargeBean.phone2}"
                        amount2="#{RechargeBean.amount2}"
                        msisdn3="#{RechargeBean.phone3}"
                        amount3="#{RechargeBean.amount3}"
                        proceedButtonAction="#{RechargeBean.approveMany()}"
                        cancelButtonAction="#{RechargeBean.cancelMany()}"
                        /> 
                </h:form>
            </h:panelGroup>
            
        </div>
        <!--End Popup -->
        
        
        <div class="clear" style="margin-bottom:50px;border:0px solid blue;"></div>
        
        <ui:include src="templates/footer.xhtml" />  
        
        
        
        <!-- SCRIPTS -->
        <script type="text/javascript" src="js_cust/mobmenu.js"></script>
        <script>
            $(document).ready(function () {
                $('#parentVerticalTab').easyResponsiveTabs({
                    type: 'vertical',
                    width: 'auto',
                    fit: true,
                    closed: 'accordion',
                    tabidentify: 'hor_1'
                });
            });
        </script>
        
        
        <script type="text/javascript">
            var showEdit=false;
            var showEditMany=false;
            var showDetails=false;
            var turnDataTable=false;
            var content2Show="";
            
            function notifiyViewDetails(){
                showEdit=false;
                showEditMany=false;
                showDetails=true;
            }
            
            function notifyEdit(){
                showEdit=true;
                showEditMany=false;
                showDetails=false;
            }
            
            function notifyEditMany(){
                showEdit=false;
                showEditMany=true;
                showDetails=false;
                
            }
            
            function notifiyDatatableRefresh(){
                
                turnDataTable=true;
                
            }
            
            
            
            jsf.ajax.addOnEvent(function(data) {                  
                switch (data.status) { //Can be "begin", "complete" and "success"
                    
                    case "begin": // This is called right before ajax request is been sent.
                        
                        break;
                    
                    case "complete": // This is called right after ajax response is received.
                     
                        break;
                    case "success": // This is called when ajax response is successfully processed.
                        
                        lightcase.start({
                            href: '#',
                            maxWidth: 640,
                            maxHeight: '700',
                            transition: 'scrollTop',
                            speedIn:'600',
                            speedOut:'600',
                            forceWidth:true,
                            swipe: true,
                            useKeys: true,
                            overlayOpacity:0.8,
                            title:'',
                            showSequenceInfo: false,
                            onFinish: {
                                function () {
                                    
                                    if(showDetails){
                                        
                                        content2Show= $('#viewDetailsContentPanel').html();
                                    }
                                    
                                    if(showEdit){
                                        content2Show= $('#editDetailsContentPanel').html();
                                    }
                                    
                                    if(showEditMany){
                                        content2Show= $('#editDetailsManyContentPanel').html();
                                    }
                                    
                                    if(turnDataTable){
                                        turn2DataTable('dataTableList');
                                        turnDataTable=false;
                                    }
                                    
                                    lightcase.get('contentInner').children().html(content2Show);
                                    // Do a resize now after filling in the content
                                    lightcase.resize();
                                }
                            }
                        });
                        
                        break;
                }
            });
            
        </script> 
        <!-- End SCRIPTS -->
        
        <!--Payment Script-->
        <script type="text/javascript">
            
            var QTCheckout = QTCheckout || {};
            var testMode = true;
            var baseUrl = "";
            var reqRef = "6065" + (Math.floor(Math.random() * 16065065560056061)).toString();

            QTCheckout.paymentItems = QTCheckout.paymentItems || [];
            QTCheckout.paymentItems.push({
                paymentCode: 95101,
                extraData: {
                    amount: "10000",
                    buttonSize: "medium",
                    customerId: "001",
                    mobileNumber: "08080808080",
                    emailAddress: "test@test.com",
                    redirectUrl: "http://localhost:8080/AirtimeWebPortal/paymentServlet",
                    requestReference: "default"
                }
            });
            
            
            if (testMode == true) {
                baseUrl = "https://pwq.sandbox.interswitchng.com/scripts/quickteller-checkout-min.js?v=";
                
            }
            else {
                baseUrl = "https://paywith.quickteller.com/scripts/quickteller-checkout-min.js?v=";
            }

            
            if (!QTCheckout.qtScript) {
                
                var qtScript = document.createElement('script');
                qtScript.type = 'text/javascript';
                qtScript.async = true;
                qtScript.src = baseUrl + new Date().getDay();
                var s = document.getElementsByTagName('script')[0];
                s.parentNode.insertBefore(qtScript, s);
                QTCheckout.qtScript = qtScript;
                
            }
            
            else if (QTCheckout.buildPaymentItemsUI) {
                
                QTCheckout.buildPaymentItemsUI();
            }

        </script>
        <!--End Payment Script-->
        
    </h:body>
</html>

